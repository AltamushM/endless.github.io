<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Endless Art Gallery</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: Arial, sans-serif;
            background-color: #000000;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .header {
            width: 100%;
            padding: 20px;
            background-color: #000000;
            display: flex;
            justify-content: center;
            align-items: center;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 10;
        }

        .logo {
            color: white;
            font-size: 1.5em;
            font-weight: bold;
            text-align: center;
            align-content: center;
        }

        .gallery-container {
            flex: 1;
            display: flex;
            justify-content: center;
            width: 100%;
            overflow: hidden;
            position: relative;
            padding: 0;
        }

        #gallery {
            width: 80%;
            height: 100%;
            overflow-y: scroll;
            scroll-behavior: smooth;
            scrollbar-width: none;
            -ms-overflow-style: none;
            padding-bottom: 100px;
        }

        #gallery::-webkit-scrollbar {
            display: none;
        }

        .fade-overlay-top, .fade-overlay-bottom {
            position: fixed;
            left: 0;
            right: 0;
            height: 100px;
            pointer-events: none;
            z-index: 5;
        }

        .fade-overlay-top {
            top: 60px;
            background: linear-gradient(to bottom, 
                rgba(0,0,0,1) 0%, 
                rgba(0,0,0,0) 100%);
        }

        .fade-overlay-bottom {
            bottom: 0;
            background: linear-gradient(to top, 
                rgba(0,0,0,1) 0%, 
                rgba(0,0,0,0) 100%);
        }

        .art-piece {
            display: block;
            width: 100%;
            height: auto;
            margin: 0;
            padding: 0;
            cursor: pointer;
            transition: transform 0.5s ease;
        }

        .horizontal-scroll-panel {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            display: flex;
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            z-index: 20;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s ease;
        }

        .horizontal-scroll-panel.active {
            opacity: 1;
            pointer-events: auto;
        }

        .art-info {
            flex: 0 0 100%;
            scroll-snap-align: start;
            display: flex;
            padding: 40px;
            box-sizing: border-box;
        }

        .art-info-content {
            width: 60%;
            color: #ffffff;
            padding-right: 40px;
        }

        .art-info-image {
            width: 40%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .art-info-image img {
            max-width: 100%;
            max-height: 80vh;
            object-fit: contain;
        }

        .art-info h2 {
            font-size: 2.5em;
            margin-bottom: 20px;
        }

        .art-info p {
            font-size: 1.2em;
            line-height: 1.6;
        }

        .close-button {
            position: fixed;
            top: 20px;
            right: 20px;
            font-size: 2em;
            color: #ffffff;
            cursor: pointer;
            z-index: 30;
            display: none;
        }

        .fade-overlay-left, .fade-overlay-right {
            position: fixed;
            top: 0;
            bottom: 0;
            width: 100px;
            pointer-events: none;
            z-index: 25;
        }

        .fade-overlay-left {
            left: 0;
            background: linear-gradient(to right, 
                rgba(0,0,0,1) 0%, 
                rgba(0,0,0,0) 100%);
        }

        .fade-overlay-right {
            right: 0;
            background: linear-gradient(to left, 
                rgba(0,0,0,1) 0%, 
                rgba(0,0,0,0) 100%);
        }

        #backgroundCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo">ENDLESS.WIP</div>
    </div>

    <div class="gallery-container">
        <div class="fade-overlay-top"></div>
        <div class="fade-overlay-bottom"></div>
        <div id="gallery"></div>
        <canvas id="backgroundCanvas"></canvas>
    </div>

    <div class="horizontal-scroll-panel" id="horizontalPanel">
        <div class="fade-overlay-left"></div>
        <div class="fade-overlay-right"></div>
    </div>

    <div class="close-button" id="closeButton">âœ•</div>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        console.log('DOM fully loaded');
        const gallery = document.getElementById('gallery');
        const canvas = document.getElementById('backgroundCanvas');
        const ctx = canvas.getContext('2d');
        const horizontalPanel = document.getElementById('horizontalPanel');
        const closeButton = document.getElementById('closeButton');
        let currentIndex = 0;
        let isHorizontalMode = false;

        const artPieces = [
            {
                src: 'Images/Slice 26.png',
                title: 'This one',
                artist: 'He who did',
                year: '1922',
                description: 'A painting that which was painted elegantly with the elegance of paint.',
                longDescription: 'This is a longer description about "This one" and its artist "He who did". It can include more details about the artwork, the artist\'s style, and historical context.'
            },
            {
                src: 'Images/Slice 25.png',
                title: 'That one',
                artist: 'Kanye',
                year: '1931',
                description: 'And I always find yeah I always find something wrong.',
                longDescription: 'This is a longer description about "That one" and its artist "He who did". It can include more details about the artwork, the artist\'s style, and historical context.'
            },
            {
                src: 'Images/Slice 24.png',
                title: 'RIP',
                artist: 'Pop Smoke',
                year: '1665',
                description: 'Yurrrrrrrr',
                longDescription: 'This is a longer description about "RIP" and its artist "He who did". It can include more details about the artwork, the artist\'s style, and historical context.'
            },
            {
                src: 'Images/Slice 23.png',
                title: 'Munchin',
                artist: 'Edvard Munch',
                year: '12',
                description: 'Yeah boy',
                longDescription: 'This is a longer description about "Munchin" and its artist "He who did". It can include more details about the artwork, the artist\'s style, and historical context.'
            },
            {
                src: 'Images/Slice 22.png',
                title: 'Phineas and Ferb',
                artist: 'Candice',
                year: '1486',
                description: 'I think I know what to do today.',
                longDescription: 'This is a longer description about "Phineas and Ferb" and its artist "He who did". It can include more details about the artwork, the artist\'s style, and historical context.'
            },
            {
                src: 'Images/Slice 21.png',
                title: 'Phineas and Ferb',
                artist: 'Candice',
                year: '1486',
                description: 'I think I know what to do today.',
                longDescription: 'This is a longer description about "Phineas and Ferb" and its artist "He who did". It can include more details about the artwork, the artist\'s style, and historical context.'
            },
            {
                src: 'Images/Slice 20.png',
                title: 'Bebadoobe',
                artist: 'Yeah',
                year: '1486',
                description: 'I think I know what to do today.',
                longDescription: 'This is a longer description about "Phineas and Ferb" and its artist "He who did". It can include more details about the artwork, the artist\'s style, and historical context.'
            },
            {
                src: 'Images/Slice 19.png',
                title: 'Phineas and Ferb',
                artist: 'Candice',
                year: '1486',
                description: 'I think I know what to do today.',
                longDescription: 'This is a longer description about "Phineas and Ferb" and its artist "He who did". It can include more details about the artwork, the artist\'s style, and historical context.'
            },
            {
                src: 'Images/Slice 18.png',
                title: 'Phineas and Ferb',
                artist: 'Candice',
                year: '1486',
                description: 'I think I know what to do today.',
                longDescription: 'This is a longer description about "Phineas and Ferb" and its artist "He who did". It can include more details about the artwork, the artist\'s style, and historical context.'
            },
            {
                src: 'Images/Slice 17.png',
                title: 'Phineas and Ferb',
                artist: 'Candice',
                year: '1486',
                description: 'I think I know what to do today.',
                longDescription: 'This is a longer description about "Phineas and Ferb" and its artist "He who did". It can include more details about the artwork, the artist\'s style, and historical context.'
            },
        ];

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }

        function createArtPiece(piece, index) {
            console.log('Creating art piece:', index);
            const img = new Image();
            img.crossOrigin = "Anonymous";
            img.src = piece.src;
            img.className = 'art-piece';
            img.dataset.index = index;
            img.addEventListener('load', updateBackground);
            img.addEventListener('click', () => openHorizontalScroll(index));
            return img;
        }

        function loadMoreArt() {
            for (let i = 0; i < 3; i++) {
                const index = (currentIndex + i) % artPieces.length;
                const img = createArtPiece(artPieces[index], index);
                gallery.appendChild(img);
            }
            currentIndex = (currentIndex + 3) % artPieces.length;
        }

        function getAverageColor(img, x, y, width, height) {
            const tempCanvas = document.createElement('canvas');
            const tempCtx = tempCanvas.getContext('2d');
            tempCanvas.width = width;
            tempCanvas.height = height;
            tempCtx.drawImage(img, x, y, width, height, 0, 0, width, height);
            const data = tempCtx.getImageData(0, 0, width, height).data;
            let r = 0, g = 0, b = 0;
            for (let i = 0; i < data.length; i += 4) {
                r += data[i];
                g += data[i+1];
                b += data[i+2];
            }
            const count = data.length / 4;
            return `rgb(${Math.round(r/count)}, ${Math.round(g/count)}, ${Math.round(b/count)})`;
        }

        function updateBackground() {
            const visibleImages = Array.from(gallery.querySelectorAll('.art-piece')).filter(img => {
                const rect = img.getBoundingClientRect();
                return rect.top < window.innerHeight && rect.bottom > 0;
            });

            if (visibleImages.length === 0) return;

            const gradientColors = visibleImages.flatMap(img => [
                getAverageColor(img, 0, 0, img.width, 10),                    // Top
                getAverageColor(img, img.width - 10, 0, 10, img.height),      // Right
                getAverageColor(img, 0, img.height - 10, img.width, 10),      // Bottom
                getAverageColor(img, 0, 0, 10, img.height)                    // Left
            ]);

            const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
            gradientColors.forEach((color, index) => {
                gradient.addColorStop(index / (gradientColors.length - 1), color);
            });

            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
        }

        function handleScroll() {
            if (gallery.scrollTop + gallery.clientHeight >= gallery.scrollHeight - 500) {
                loadMoreArt();
            }
            updateBackground();
        }

        function openHorizontalScroll(clickedIndex) {
            console.log('Opening horizontal scroll for index:', clickedIndex);
            horizontalPanel.innerHTML = '';
            const piece = artPieces[clickedIndex];

            const artInfo = document.createElement('div');
            artInfo.classList.add('art-info');

            const artInfoContent = document.createElement('div');
            artInfoContent.classList.add('art-info-content');

            const title = document.createElement('h2');
            title.textContent = piece.title;
            artInfoContent.appendChild(title);

            const artist = document.createElement('p');
            artist.textContent = `Artist: ${piece.artist}`;
            artInfoContent.appendChild(artist);

            const year = document.createElement('p');
            year.textContent = `Year: ${piece.year}`;
            artInfoContent.appendChild(year);

            const description = document.createElement('p');
            description.textContent = piece.longDescription;
            artInfoContent.appendChild(description);

            const artInfoImage = document.createElement('div');
            artInfoImage.classList.add('art-info-image');

            const img = new Image();
            img.src = piece.src;
            artInfoImage.appendChild(img);

            artInfo.appendChild(artInfoContent);
            artInfo.appendChild(artInfoImage);

            horizontalPanel.appendChild(artInfo);
            horizontalPanel.classList.add('active');
            closeButton.style.display = 'block';
        }

        closeButton.addEventListener('click', () => {
            horizontalPanel.classList.remove('active');
            closeButton.style.display = 'none';
        });

     
        resizeCanvas();
        loadMoreArt();

       
        window.addEventListener('resize', resizeCanvas);
        gallery.addEventListener('scroll', handleScroll);

        updateBackground();
    });

    </script>
</body>
</html>
